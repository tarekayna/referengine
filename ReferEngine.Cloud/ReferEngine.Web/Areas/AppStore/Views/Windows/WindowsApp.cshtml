@using ReferEngine.Common.Data
@using ReferEngine.Common.Models
@model ReferEngine.Common.ViewModels.AppStore.Windows.WindowsAppViewModel

@{
    bool isWindows8 = Model.UserAgentProperties.IsWindows8;
    bool supportsProtocolLaunching = Model.UserAgentProperties.SupportsProtocolLaunching;
    WindowsAppStoreInfo appInfo = Model.WindowsAppStoreInfo;
}

@*@section styles
{
    @Styles.Render("~/bundles/less/fb/app")
}*@

@*
@section scripts
{    @if (Model.App.VimeoLink != null || Model.App.YouTubeLink != null)
    {
        @Scripts.Render("~/bundles/js/jquery.fitvids")
    }
    @{
        string bgImageName = string.IsNullOrEmpty(Model.App.BackgroundImage) ? "app_default_background_dsgi1h.jpg" :
                             Model.App.BackgroundImage;   
    } 
    <script type="text/javascript">
        var height = window.screen.availHeight;
        var width = window.screen.availWidth;
        var transformation = "w_" + width + ",h_" + height + "e_blur:700,c_fill";
        bgImageLink = "@ImageData.BaseLink" + transformation + "/" + "@bgImageName";
        var elem = $("#bg-image-container img");
        elem.attr("src", bgImageLink);
        elem.css("width", window.innerWidth + "px");
        elem.css("height", window.innerHeight + "px");
        $(window).resize(function () {
            elem.css("width", window.innerWidth + "px");
            elem.css("height", window.innerHeight + "px");
        });
    </script>
}

@section CustomHead
{
    <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# referengine: http://ogp.me/ns/fb/referengine#">
    
    <meta name="msApplication-ID"content="microsoft.build.App"/>
    <meta name="msApplication-PackageFamilyName"content="@appInfo.PackageFamilyName"/>
    
    <meta property="fb:app_id"             content="368842109866922" /> 
    <meta property="og:type"               content="referengine:app" /> 
    <meta property="og:url"                content="@string.Format("https://www.ReferEngine.com/apps/windows/{0}/{1}", @appInfo.Category, @appInfo.Name.ToLower().Replace(' ', '-'))" />
    <meta property="og:title"              content="@appInfo.Name" />
    <meta property="og:description"        content="@appInfo.DescriptionHtml" /> 
    <meta property="referengine:platform"  content="Windows" />
        @if (appInfo.StoreAppScreenshots != null)
        {
            foreach (var img in appInfo.StoreAppScreenshots)
            {
                <meta property="og:image" content="@img.Link" />
            }
        }
}
        
<div id="bg-image-container" style="position: fixed; top: 0; left:0; z-index: -50">
    <img/>
</div>

<div id="landing" style="background-color: rgba(0,0,0,0.75); color: white !important">
    <div class="container">
        <div class="row">
            <div class="span12">
                <img src="@appInfo.LogoLink" alt="@appInfo.Name Logo" class="app-logo" />

                <h2>@appInfo.Name for Windows</h2>
                <p>@Html.Raw(appInfo.DescriptionHtml)</p>
                <div class="center-content store-logo-ctnr">
                
                    @{
                        string storeLink = "";
                        bool showDataToggle = false;
                    }
                    @if (isWindows8)
                    {
                        if (supportsProtocolLaunching)
                        {
                            storeLink = "ms-windows-store:PDP?PFN=" + appInfo.PackageFamilyName;
                        }
                        else
                        {
                            storeLink = "#cantOpenStore";
                            showDataToggle = true;
                        }
                    }
                    else
                    {
                        storeLink = "#notWin8";
                        showDataToggle = true;
                    }
                    <a href="@storeLink" @if (showDataToggle) { <text>role = "button" data-toggle = "modal"</text> }>
                        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="250px"
                             height="150px" viewBox="0 0 250 150" enable-background="new 0 0 250 150" xml:space="preserve">
                            <g id="Layer_2">
                                @{
                                    string bgColor = string.IsNullOrEmpty(appInfo.BackgroundColor) ?
                                                         appInfo.BackgroundColor : "#00AFF0";
                                }
                                <rect fill="@bgColor" width="250" height="150"/>
                            </g>
                            <g id="Layer_1">
                                <g>
                                    <g id="bag_18_">
                                        <g id="handles_18_">
                                            <path fill="#FFFFFF" d="M117.249,27.803c-3.407,1.198-5.897,2.221-5.897,8.727v3.131l2.041-0.411v-2.704
					                    c-0.051-4.414,1.097-5.337,4.074-6.622C117.453,29.091,117.379,28.385,117.249,27.803z"/>
                                            <path fill="#FFFFFF" d="M123.182,26.411c0.135,0.63,0.242,1.315,0.314,2.052c5.334-0.767,5.232,1.433,5.232,6.026v1.697
					                    l2.018-0.415v-1.283C130.746,27.356,129.633,25.445,123.182,26.411z"/>
                                            <path fill="#FFFFFF" d="M102.162,41.498v-9.382c-0.065-5.811,2.937-7.59,8.478-8.889c8.347-1.958,8.877,3.424,8.877,6.847v7.953
					                    l2.045-0.413V30.25c-0.021-6.479-2.041-11.331-11.331-9.226c-5.002,1.135-10.11,2.411-10.11,10.899v9.98L102.162,41.498z"/>
                                        </g>
                                        <path fill="#FFFFFF" d="M140.961,36.202L84.807,47.429v40.84l56.154,11.229l11.225-4.084V40.285L140.961,36.202z M109.34,79.822
				                    l-12.459-1.756V67.723h12.459V79.822z M109.34,66.154H96.881V56.64l12.459-1.759V66.154z M126.613,82.215l-15.708-2.295V67.723
				                    h15.708V82.215z M126.613,66.154h-15.708V54.789l15.708-2.3V66.154z"/>
                                    </g>
                                </g>
                                <text transform="matrix(1 0 0 1 21.209 131.6768)" fill="#FFFFFF" font-family="'Segoe UI Semilight'" font-size="14">Download from the Windows Store</text>
                            </g>
                        </svg>
                    </a>
                </div>  
            </div>
        </div>
    </div>
</div>    
 
@if (appInfo.StoreAppScreenshots != null && appInfo.StoreAppScreenshots.Count() > 0)
{
	<div class="container">  
    <div class="row">
	    <div class="span10 offset1 txt-middle">
            <div id="imageCarousel" class="carousel slide">
                <div class="carousel-inner">
                    @for (int i = 0; i < appInfo.StoreAppScreenshots.Count(); i++)
                    {
                        var screenshot = appInfo.StoreAppScreenshots.ElementAt(i);
                        <div class="@MvcHtmlString.Create(i == 0 ? "active" : "") item">
                            <img alt="@screenshot.Caption" src="@ImageData.GetLink(screenshot.Link)">
                            <p>@screenshot.Caption</p>
                        </div>
                    } 
                </div>
                    <a class="carousel-control left" href="#imageCarousel" data-slide="prev">&lsaquo;</a>
                    <a class="carousel-control right" href="#imageCarousel" data-slide="next">&rsaquo;</a>
                </div>
            </div>
        </div>
    </div>
}
        
<div id="copywrite">
	<div class="container">
	<div class="row">
		<div class="span12">
		<p>@Html.Raw(appInfo.Copyright)</p>
		</div>		  
	</div>	  
    </div>	  
</div>

@if (isWindows8 && !supportsProtocolLaunching)
{
<div id="cantOpenStore" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h3 class="text-error">Oops! Browser Can't Open Windows Store</h3>
    </div>
    <div class="modal-body">
        <p>
            This browser can't open the Windows Store directly from a website. These browsers support this action: 
            Firefox and Internet Explorer.
        </p>
        <h4 class="text-success">How can I get this app?</h4>
        
        <div class="accordion" id="accordion2">
          <div class="accordion-group">
            <div class="accordion-heading">
              <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseOne">
                The Regular Way
              </a>
            </div>
            <div id="collapseOne" class="accordion-body collapse in">
              <div class="accordion-inner">
                <ol>
                    <li>
                        Launch the Windows Store
                    </li>
                    <li>
                        Search for "@appInfo.Name"<br />
                        <small>Hint: You can start typing at the homepage of the Windows Store to start searching</small>
                    </li>
                </ol>
              </div>
            </div>
          </div>
          <div class="accordion-group">
            <div class="accordion-heading">
              <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseTwo">
                The Geeky Way
              </a>
            </div>
            <div id="collapseTwo" class="accordion-body collapse">
              <div class="accordion-inner">
                <ol>
                    <li>
                        Launch the Command Prompt <br/>
                        <small>Hint: Hit WinKey + R, Type "cmd", Hit Enter</small>
                    </li>
                    <li>
                        Type or Copy paste this: <br />
                        <code>start ms-windows-store:PDP?PFN=@appInfo.PackageFamilyName</code>
                    </li>
                    <li>
                        Hit Enter
                    </li>
                </ol>
              </div>
            </div>
          </div>
        </div>
    </div>
</div>        
}
else if (!isWindows8)
{
    <div id="notWin8" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h3>Oops! Not a Windows 8 PC</h3>
        </div>
        <div class="modal-body">
            <p>
                @appInfo.Name is a Windows 8 application.
                You need to be on a Windows 8 PC to open the Windows Store and view @appInfo.Name.
            </p>
        </div>
    </div>      
}

*@

@if (Model.App != null)
{
    <script> 
        window.re = {};
        window.re["appId"] = "@Model.App.Id";
    </script>
    
    <script data-main="/typescript/appstore/windows/windowsApp.js" type="text/javascript" src="~/typescript/lib/require.js"></script>
}

<div class="row">
	<div class="span4">
		<aside>
		<div class="widget">
			<h4 class="heading-success"><span class="btn btn-large btn-success"><i class="m-icon-big-swapdown m-icon-white"></i></span>&nbsp;&nbsp;Author detail</h4>
			<img src="~/areas/assets/img/avatar.png" class="alignleft" alt="" />
			<h5>John doe</h5>
			<p>
					Donec ullamcorper nulla non metus auctor fringilla commodo luctus
			</p>
			<a href="#">Profile detail..</a>
		</div>
		<div class="widget">
			<h4 class="heading-success"><span class="btn btn-large btn-success"><i class="m-icon-big-swapdown m-icon-white"></i></span>&nbsp;&nbsp;Project detail</h4>
			<ul class="project-detal">
				<li><label>Category :</label> @appInfo.Category</li>
				<li><label>Publisher:</label> @appInfo.Developer</li>
			    <li><label><a href="@appInfo.SupportLink">Support Link</a></label></li>
			</ul>
		</div>
		</aside>
	</div>
	<div class="span8">
		<article class="blog-post">
		<div class="tooltip-demo headline">
			<h4>@appInfo.Name</h4>
			<span class="comment"><a href="#" data-rel="tooltip" data-placement="top" title="4 Comments">@Model.NumberOfRecommendations recommendations</a></span>
		</div>
		<div class="clearfix">
		</div>
		<div class="well">
		    <a href="#">
		        <img src="~/areas/assets/img/dummies/big.jpg" alt="" />
		    </a>
			<h5>Description : </h5>
			<p>@Html.Raw(appInfo.DescriptionHtml)</p>
			<a href="#" class="btn btn-large btn-success">Download here</a>
		</div>
		</article>
        
        @if (Model.App != null)
        {
            <h4>Latest Recommendations</h4>
            <ul class="media-list">
                <li class="media">
                    <a class="pull-left" href="#">
                        <img class="media-object" src="~/areas/assets/img/small-avatar.png" alt="" />
                    </a>
                    <div class="media-body">
                        <h5 class="media-heading"><a href="#">Dean maximus</a></h5>
                        <span>Post :05/12/2012</span>
                        <p>
                            Cras sit amet nibh libero, in gravida nulla. Nulla vel metus scelerisque ante sollicitudin commodo. Cras purus odio, vestibulum in vulputate at, tempus viverra turpis.
                        </p>
                        <a class="btn btn-small" href="">Reply comment</a>
                        <!-- Nested media object -->
                        <div class="media">
                            <a class="pull-left" href="#">
                                <img class="media-object" src="~/areas/assets/img/small-avatar.png" alt="" />
                            </a>
                            <div class="media-body">
                                <h5 class="media-heading"><a href="#">Cris Need</a></h5>
                                <span>Post :08/12/2012</span>
                                <p>
                                    Cras sit amet nibh libero, in gravida nulla. Nulla vel metus scelerisque ante sollicitudin commodo. Cras purus odio, vestibulum in vulputate at, tempus viverra turpis.
                                </p>
                                <a class="btn btn-small" href="">Reply comment</a>
                                <!-- Nested media object -->
                                <div class="media">
                                    <a class="pull-left" href="#">
                                        <img class="media-object" src="~/areas/assets/img/small-avatar.png" alt="" />
                                    </a>
                                    <div class="media-body">
                                        <h5 class="media-heading"><a href="#">Nooer neyh</a></h5>
                                        <span>Post :11/12/2012</span>
                                        <p>
                                            Cras sit amet nibh libero, in gravida nulla. Nulla vel metus scelerisque ante sollicitudin commodo. Cras purus odio, vestibulum in vulputate at, tempus viverra turpis.
                                        </p>
                                        <a class="btn btn-small" href="">Reply comment</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Nested media object -->
                        <div class="media">
                            <a class="pull-left" href="#">
                                <img class="media-object" src="~/areas/assets/img/small-avatar.png" alt="" />
                            </a>
                            <div class="media-body">
                                <h5 class="media-heading"><a href="#">Andinia new</a></h5>
                                <span>Post :15/12/2012</span>
                                <p>
                                    Cras sit amet nibh libero, in gravida nulla. Nulla vel metus scelerisque ante sollicitudin commodo. Cras purus odio, vestibulum in vulputate at, tempus viverra turpis.
                                </p>
                                <a class="btn btn-small" href="">Reply comment</a>
                            </div>
                        </div>
                    
                        <!-- ko foreach: PeopleData -->
                        <div class="media" style="margin-bottom: 18px; color: gray; line-height: normal">
                            <div class="storyContainer span10 offset1" style="border-top: 1px solid #e9e9e9; padding: 18px 0 0 18px; border-left: 1px solid #e9e9e9;
                                                                                                                                           font-family: 'lucida grande', tahoma, verdana, arial, sans-serif">
                                <span class="" style="float: left; padding-right: 18px; height: 80px">
                                    <img data-bind="attr:{src: PictureUrl}" />                        
                                </span>
                                <span class="" style="padding-left: 86px">
                                    <p style="font-size: 13px">
                                        <span data-bind="text: Name" style="font-weight: bold !important; color: #3b5998"></span>
                                        recommended @Model.App.Name<span data-bind="text: ToFriends"></span>.
                                    </p> 
                                    <p style="font-size: 11px; color: #999; margin-top: -5px !important;">
                                        <span data-bind="text: Time"></span>
                                        <span data-bind="visible: Location">
                                            near <span data-bind="text: Location"></span>
                                        </span>
                                    </p>
                                    <p style="font-size: 13px; color: #333" data-bind="text: UserMessage"></p>
                                </span>                        
                            </div>
                        </div>
                        <!-- /ko -->
                    </div>
                </li>
                <li class="media">
                    <a class="pull-left" href="#">
                        <img class="media-object" src="~/areas/assets/img/small-avatar.png" alt="" />
                    </a>
                    <div class="media-body">
                        <h5 class="media-heading"><a href="#">Maouses chees</a></h5>
                        <span>Post :16/12/2012</span>
                        <p>
                            Cras sit amet nibh libero, in gravida nulla. Nulla vel metus scelerisque ante sollicitudin commodo. Cras purus odio, vestibulum in vulputate at, tempus viverra turpis.
                        </p>
                        <a class="btn btn-small" href="">Reply comment</a>
                    </div>
                </li>
            </ul>
        }
	</div>
</div>