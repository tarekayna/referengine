function setTabClickEvents(){$("#overviewTab").click(function(n){n.preventDefault(),$(this).tab("show")}),$("#mapTab").click(function(n){n.preventDefault(),$(this).tab("show")})}function setWhenHandler(n,t){$("#"+n).click(function(){Map.when!==n&&(Map.when=n,Map.refresh()),$("#current-when").text(t)})}function setWhenHandlers(){setWhenHandler("past-year","Past year"),setWhenHandler("past-90-days","Past 90 days"),setWhenHandler("past-60-days","Past 60 days"),setWhenHandler("past-30-days","Past 30 days"),setWhenHandler("past-7-days","Past 7 days"),setWhenHandler("past-3-days","Past 3 days"),setWhenHandler("past-48-hours","Past 48 hours"),setWhenHandler("past-24-hours","Past 24 hours")}function setHowHandler(n,t){$("#"+n).click(function(){Map.how!==n&&(Map.how=n,Map.refresh()),$("#current-how").text(t)})}function setHowHandlers(){setHowHandler("heat-map","Heat Map"),setHowHandler("location-map","Location Map")}function setWhoHandler(n,t){$("#"+n).click(function(){Map.who!==n&&(Map.who=n,Map.refresh()),$("#current-who").text(t)})}function setWhoHandlers(){setWhoHandler("launched","launched "+re.appName),setWhoHandler("intro","saw the Refer Engine intro page"),setWhoHandler("recommended","recommended "+re.appName)}var NotificationType=function(){function n(){}return n.none="",n.info="info",n.success="success",n.error="error",n}(),Notifications=function(){function n(){}return n.show=function(n,t){$(".top-right").notify({message:{text:n},transition:"fade",type:t}).show()},n}(),Map=function(){function n(){}return n.mapData=[],n.heatData=[],n.markers=[],n.how="location-map",n.who="launched",n.when="past-30-days",n.center=new google.maps.LatLng(0,0),n.options={center:n.center,zoom:2,mapTypeId:google.maps.MapTypeId.ROADMAP,streetViewControl:!1,mapTypeControl:!1},n.map=new google.maps.Map(document.getElementById("map-canvas"),n.options),n.updateHeatmapData=function(){n.heatData=[];for(var t=0;t<n.mapData.length;t++)n.heatData.push(n.mapData[t].latlong);n.heatMap=new google.maps.visualization.HeatmapLayer({data:n.heatData})},n.showHeatmap=function(){n.updateHeatmapData(),n.heatMap.setMap(n.map)},n.hideHeatmap=function(){n.heatMap!==undefined&&n.heatMap.setMap(null)},n.removeMarkers=function(){for(var t=0;t<n.markers.length;t++)n.markers[t].setMap(null)},n.updateMarkers=function(){n.removeMarkers();for(var t=0;t<n.mapData.length;t++)n.markers.push(new google.maps.Marker({position:n.mapData[t].latlong,map:n.map,title:n.mapData[t].city,origin:new google.maps.Point(16,16),anchor:new google.maps.Point(16,16),icon:"https://referenginestorage.blob.core.windows.net/referengine-design/logo-mark-32.png"}))},n.refresh=function(){var t=function(t){n.mapData=[];for(var i=0;i<t.length;i++)n.mapData.push({latlong:new google.maps.LatLng(t[i].Latitude,t[i].Longitude),city:t[i].City});n.how==="location-map"?(n.updateMarkers(),n.hideHeatmap()):n.how==="heat-map"&&(n.removeMarkers(),n.showHeatmap()),Notifications.show("Success: map updated",NotificationType.success)},i=function(){Notifications.show("Error: could not update map",NotificationType.error)};$.ajax("../GetAppDashboardMapData",{type:"POST",data:{id:re.appId,who:n.who,when:n.when},dataType:"json",error:i,success:t}),Notifications.show("Refreshing map...",NotificationType.info)},n}();$(document).ready(function(){Map.refresh(),setTabClickEvents(),setWhenHandlers(),setHowHandlers(),setWhoHandlers()})