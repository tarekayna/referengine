var ReferEngine;(function(n){function rt(){var n=Windows.Networking.Connectivity.NetworkInformation.getInternetConnectionProfile();if(n===null){var t=new Windows.UI.Popups.MessageDialog("ReferEngine requires a working internet connection.","Not Connected to the Internet");return t.showAsync(),!1}return!0}function ut(){rt()&&(u.loadIntro(),WinJS.UI.Animation.fadeIn(t.container).then(function(){s.removeClass(t.container,e)}))}function ft(){WinJS.UI.Animation.fadeOut(t.container).then(function(){s.addClass(t.container,e)})}var y,p,d="data:image/png;base64,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",g="data:image/png;base64,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",r=ReferEngineClient,f=Windows.Storage.ApplicationData.current.roamingSettings,e="re-hidden",o=!1,nt="368842109866922",w=Windows.ApplicationModel.Store,b,k=r.appActivationArgs,s=WinJS.Utilities,l;if(!r.appId)throw"ReferEngine.client.appId must be defined.";b=r.appIsPublished?w.CurrentApp:w.CurrentAppSimulator;var a=function(){var n=(new Windows.Globalization.GeographicRegion).code;return n==="US"||n==="USA"||n==="840"},v=function(){function t(){}return t.autoOpenTimeout=15e3,t._launchCount=0,Object.defineProperty(t,"launchCount",{get:function(){var n=f.values["ReferEngine-LaunchCount"];return n===null?(f.values["ReferEngine-LaunchCount"]=0,0):n},set:function(n){f.values["ReferEngine-LaunchCount"]=n},enumerable:!0,configurable:!0}),t._autoAskAgain=!0,Object.defineProperty(t,"autoAskAgain",{get:function(){var n=f.values["ReferEngine-AutoAskAgain"];return n===null?(f.values["ReferEngine-AutoAskAgain"]=a(),a()):n},set:function(n){f.values["ReferEngine-AutoAskAgain"]=n},enumerable:!0,configurable:!0}),t.shouldAutoOpen=function(){return t.launchCount%2==0&&t.autoAskAgain},t.autoOpenIfNeeded=function(){if(k){var i=k.detail.previousExecutionState,r=Windows.ApplicationModel.Activation.ApplicationExecutionState;i!==r.running&&i!==r.suspended&&t.launchCount++,t.shouldAutoOpen()&&setTimeout(function(){window.msRequestAnimationFrame(function(){n.show()})},t.autoOpenTimeout)}},t}(),t=function(){function n(){}return n}(),tt=function(){function u(){}return u.uiInitialized=!1,u.initializeUI=function(){var e,s,h,o,f,c,l;u.uiInitialized||(e=i.CreateElement("style"),e.innerText=r.style,e.type="text/css",s=document.getElementsByTagName("link")[0],s.parentNode.insertBefore(e,s),h=document.querySelector("body"),t.container=i.CreateDiv("re-container"),h.appendChild(t.container),t.iframe=i.CreateElement("iframe"),t.container.appendChild(t.iframe),t.loading=i.CreateDiv("re-loading-container"),t.container.appendChild(t.loading),o=i.CreateDiv("re-close"),o.innerText="",t.loading.appendChild(o),o.addEventListener("click",n.hide),t.progress=i.CreateElement("progress"),t.progress.className="win-ring",f=i.CreateDiv(null),t.loading.appendChild(f),c=i.CreateImg(d,"re-logo-mark"),l=i.CreateImg(g,"re-logo-text"),t.loadingTextElem=i.CreateDiv("re-loading-text"),f.appendChild(c),f.appendChild(l),f.appendChild(t.progress),f.appendChild(t.loadingTextElem),window.addEventListener("message",it.onWindowMessage),u.uiInitialized=!0)},u}(),h=function(){function n(){}return n.base=r.baseUrl,n.intro=n.base+"/recommend/win8/intro/"+r.appId,n.auth=n.base+"/api/win8/auth",n.recommend=function(){var t="fb_access_code="+p+"&re_auth_token="+y;return t=t.replace("#","%23"),n.base+"/recommend/win8/recommend"+t}(),n}(),i=function(){function n(){}return n.CreateElement=function(n){return document.createElement(n)},n.CreateDiv=function(t){var i=n.CreateElement("div");return t!==null&&t!==undefined&&(i.className=t),i},n.CreateImg=function(t,i){var r=n.CreateElement("img");return r.src=t,r.className=i,r},n}(),u=function(){function n(){}return n.hideRing=function(){t.progress.style.opacity="0"},n.showRing=function(){t.progress.style.opacity="1"},n.show=function(){WinJS.UI.Animation.fadeIn(t.loading).then(function(){s.removeClass(t.loading,e)})},n.hide=function(){WinJS.UI.Animation.fadeOut(t.loading).then(function(){s.addClass(t.loading,e)})},n.setText=function(i){i.substr(0,5)==="Error"&&n.hideRing(),t.loadingTextElem.innerText=i},n.loadIntro=function(){tt.initializeUI(),t.iframe.src=h.intro,n.setText("Loading..."),n.showRing();var i=1e4;setTimeout(function(){o||(n.setText("This is taking longer than usual..."),setTimeout(function(){o||(n.setText("Almost there..."),setTimeout(function(){o||n.setText("Error: The service is not responding. Sorry for that. Please try again in a while.")},i))},i))},i)},n}(),it=function(){function i(){}return i.onWindowMessage=function(i){var r,f;i.origin===h.base&&(r=JSON.parse(i.data),r.action==="fb-login"?(u.show(),u.setText("Loading..."),c.authFacebookAsync().then(function(n){n?(u.setText("Loading Facebook info..."),t.iframe.src=h.recommend):u.setText("Error: You must authorize Refer Engine to use your Facebook information.")})):r.action==="cancel"?(f=r.dontAskAgain,f&&(v.autoAskAgain=!1),n.hide()):r.action==="show-loading"?u.show():r.action==="hide-loading"?u.hide():r.action==="set-loading-text"?u.setText(r.text):r.action==="done"?(n.hide(),v.autoAskAgain=!1):r.action==="intro-page-loaded"&&(o=!0,c.authorizeAppAsync().done(function(n){n||c.authorizeAppAsync()},c.authorizeAppAsync),u.hide()))},i}(),c=function(){function n(){}return n.authFacebookAsync=function(){return new WinJS.Promise(function(n){var i="client_id="+nt+"&redirect_uri=https://www.referengine.com/recommend/win8/success&scope=email,publish_actions&display=popup&response_type=code",r="https://www.facebook.com/dialog/oauth?"+i,u=new Windows.Foundation.Uri(r),t=Windows.Security.Authentication.Web;t.WebAuthenticationBroker.authenticateAsync(t.WebAuthenticationOptions.none,u).done(function(t){t.responseData.indexOf("error_reason=")!==-1&&n(!1);var i="code=",r=t.responseData.indexOf(i)+i.length;p=t.responseData.substr(r),n(!0)},function(){n(!1)})})},n.authorizeAppAsync=function(){return new WinJS.Promise(function(n){b.getAppReceiptAsync().done(function(t){t="<xml>"+t+"<\/xml>";var i=window.btoa(t);WinJS.xhr({type:"POST",headers:{"Content-type":"text/xml"},url:h.auth,data:i}).done(function(t){var i=JSON.parse(t.responseText).Data;y=i.token,n(!0)},function(){n(!1)})})})},n}();if(n.show=ut,n.hide=ft,n.isAvailable=!0,a()){if(r.onLoadArray)for(l=0;l<r.onLoadArray.length;l++)r.onLoadArray[l]();v.autoOpenIfNeeded()}})(ReferEngine||(ReferEngine={}))