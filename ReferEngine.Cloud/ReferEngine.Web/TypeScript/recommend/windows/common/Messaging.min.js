define(["require","exports"],function(n,t){var i=function(){function n(n,t){this.details=t,this.functionName=n.name}return n.prototype.getString=function(){var n={functionName:this.functionName};return this.details&&(n.details=this.details),JSON.stringify(n)},n.parse=function(t){var i=JSON.parse(t),r=new n(i.msg);return r.details=i.details,r},n}(),r,u,f;t.Message=i,function(n){n._map=[],n._map[0]="IFrameToClient",n.IFrameToClient=0,n._map[1]="ClientToIframe",n.ClientToIframe=1}(t.MessengerType||(t.MessengerType={})),r=t.MessengerType,u=function(){function n(n,t){this.type=n,this.receiveOrigin=t,this.messageHandlers=[];var i=this;window.addEventListener("message",function(n){i.receive(n)})}return n.prototype.send=function(n){this.type==r.IFrameToClient?window.parent.postMessage(n.getString(),this.parentLocation):this.iframe.contentWindow.postMessage(n.getString(),this.iframe.src)},n.prototype.call=function(n,t){var r=new i(n,t);this.send(r)},n.prototype.receive=function(n){var r,t;if(n.origin===this.receiveOrigin)for(r=i.parse(n.data),t=0;t<this.messageHandlers.length;t++)this.messageHandlers[t].msg===r.functionName&&this.messageHandlers[t].handler(r.details)},n.prototype.addMessageHandler=function(n,t){this.messageHandlers.push({msg:n,handler:t})},n}(),t.Messenger=u,f=function(){function n(n,t){this.success=n,this.code=t}return n}(),t.AuthResult=f})