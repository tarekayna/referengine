define(["require","exports","common","../common/Functions"],function(n,t,i,r){var f=i,u=r;$(document).ready(function(){function v(){var n="facebookCode="+s;return n=n.replace("#","%23"),f.Url.base+"/recommend/win8/recommend?"+n}var c=$(".login"),l=$("#re-cancel"),a=$("#dontAsk"),n=f.messenger,o,t=u.ClientFunction,r=u.ServerFunction,s=null,i=f.MixPanel,e,h;c.click(function(){n.call(t.setLoadingText,{text:"Loading..."}),n.call(t.showLoading),n.call(t.authFacebook),i.track("Action",{Action:"Recommend Intro Start"})}),l.click(function(){var r=a[0].checked;n.call(t.setAutoAsk,{askAgain:!r}),n.call(t.hide),i.track("Action",{Action:"Recommend Intro Cancel","Dont Ask Again":r})}),e=!1,h=[new u.Function(r.closedWhileLoading,function(){i.track("Action",{Action:"Recommend Intro Closed While Loading"}),e=!0}),new u.Function(r.introVisible,function(){e||i.track("Page View",{Page:"Recommend Intro"})}),new u.Function(r.authFacebookResult,function(i){var r=i.authResult;r.success?(s=r.code,n.call(t.navigate,{url:v()})):(n.call(t.setLoadingText,{text:"Error: You must authorize Refer Engine to use your Facebook information."}),n.call(t.showLoading))}),],o=new u.FunctionRange(n),o.addRange(h),n.call(t.hideLoading),n.call(t.setIntroPageLoaded)})})